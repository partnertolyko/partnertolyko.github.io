<!doctype html>
<meta charset="utf-8">
<title>Auth Callback</title>
<style>body{font-family:system-ui,Segoe UI,Arial;margin:32px}</style>
<h1>Авторизация…</h1>
<p>Если переадресация не произошла автоматически, <a id="link" href="#">нажми здесь</a>.</p>
<script>
(function () {
  const p = new URLSearchParams(location.search);
  const code  = p.get('code');
  const state = p.get('state') || '';
  if (!code) {
    document.body.insertAdjacentHTML('beforeend','<p>Нет параметра <code>code</code>.</p>');
    return;
  }
  // Перекидываем код в локальное десктоп-приложение
  const target = 'http://localhost:51789/?code=' + encodeURIComponent(code) +
                 (state ? '&state=' + encodeURIComponent(state) : '');
  document.getElementById('link').href = target;
  // Мягкий redirect (замена истории, чтобы не оставить "секрет" в истории)
  location.replace(target);
})();
</script>
